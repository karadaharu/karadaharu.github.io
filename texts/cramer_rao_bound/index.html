<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クラメール-ラオの不等式の導出 &middot; Beki Kaneko</title>
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://karadaharu.org/favicon.ico"/>
    <meta name="description" content="">

    <meta name="generator" content="Hugo 0.56.3" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="クラメール-ラオの不等式の導出 &middot; Beki Kaneko">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="クラメール-ラオの不等式の導出 &middot; Beki Kaneko">
    <meta property="og:description" content="">

    <link href="//fonts.googleapis.com/css?family=Alegreya+Sans:300,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="https://karadaharu.org//css/all.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="Beki Kaneko" href="https://karadaharu.org//index.xml" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-84210686-1', 'auto');
      ga('send', 'pageview');
    
    </script>
    <script data-ad-client="ca-pub-6229665392774233" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
  <script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
  }(document, "script", "twitter-wjs"));</script>
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-7-24">
    <div class="header">
        <nav class="nav">
            <ul class="nav-list">
              <li class="nav-item">
                <a href="https://karadaharu.org/">
                  <h1 class="brand-title">
                    <span>Beki Kaneko</span>
                  </h1>
                  <h2 class="brand-title">
                    <span>金子ベキ</span>
                  </h2>
                </a>
              </li>
                <li class="nav-item nav-li">
                    <a href="https://karadaharu.org/about">about</a>
                </li>
                <li class="nav-item nav-li">
                    <a href="https://karadaharu.org/texts">texts</a>
                </li>
            </ul>
            <ul class="nav-list">
              <li class="nav-item">
                
                
                <li class="nav-item nav-sns">
                    <a class="sns-button" href="https://twitter.com/karadaharu"><i class="fa fa-twitter"></i></a>
                </li>
                
                
                
                <li class="nav-item nav-sns">
                  <a class="sns-button" href="https://karadaharu.tumblr.com"><i class="fa fa-tumblr"></i></a>
                </li>
                
                
            </ul>
            <div class="google-ad">
              <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
              
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-6229665392774233"
                   data-ad-slot="4370168858"
                   data-ad-format="auto"
                   data-full-width-responsive="true"></ins>
              <script>
                   (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
            </div>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-12-24">
      <div>
       <header class="content-header">
           <span class="post-title">クラメール-ラオの不等式の導出</span>
           <p class="post-meta">
               
               
                   <strong class="post-date_iso8601">2018-12-25</strong>
               
               
           </p>
           
            <a class="twitter-share-button" href="https://twitter.com/intent/tweet">Tweet</a>
          
       </header>
      </div>
        <div>
            
            <div class="posts">
                <section class="post">

                    <div class="post-description">
                        <h2 id="クラメール-ラオの不等式-cramer-rao-bound">クラメール-ラオの不等式(Cramer-Rao bound)</h2>

<p>パラメーター $\theta$ をもつ確率密度関数 $P(X|\theta)$ に従う確率変数 $X$ を考えます。</p>

<p>観測値 $\hat{X}$ から求めた $\theta$ の不偏推定量 $\hat{\theta}$ の分散について、以下の不等式が成り立ちます。</p>

<p>$$E[(\hat{\theta}-\theta)^2] \geq E^{-1}[(\frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta)))^2] \ .$$</p>

<h2 id="導出">導出</h2>

<p>確率変数 $X\in \mathbb{R}$ について、未知パラメーター $\theta\in \mathbb{R}$ をもつ確率密度関数 $P(X|\theta)$ を考えます。</p>

<p>いま、確率変数 $X$ の標本 $\bar{X} \in \mathbb{R}^N$ が得られたとします。$\bar{X}$ が得られる確率は、 $P(\bar{X}|\theta)$ であり、 $\bar{X}$ について積分すると、</p>

<p>$$\int P(\bar{X}|\theta) d\bar{X} =1 \ ,$$</p>

<p>となります。上式において、両辺を $\theta$ で微分すると、</p>

<p>$$\frac{\partial}{\partial\theta} \int P(\bar{X}|\theta) d\bar{X} = 0 \ .$$</p>

<p>微分演算子を積分の中にいれて、 $ P(\bar{X}|\theta)/P(\bar{X}|\theta)=1$ をかけると、</p>

<p>$$\int \frac{P(\bar{X}|\theta)}{P(\bar{X}|\theta)} \frac{\partial}{\partial\theta} P(\bar{X}|\theta) d\bar{X} = 0 \ . $$</p>

<p>ここで、</p>

<p>$$\frac{2}{P(\bar{X}|\theta)} \frac{\partial}{\partial\theta} P(\bar{X}|\theta) = \frac{\partial}{\partial\theta} \log (P(\bar{X}|\theta)) \ , $$</p>

<p>であるので、</p>

<p>$$\int P(\bar{X}|\theta) \frac{\partial}{\partial\theta} \log (P(\bar{X}|\theta))  d\bar{X} = 0 \ .$$</p>

<p>上式は、$\theta$ についての対数尤度  $\log(P(\bar{X}|\theta))$ の期待値が\$0\$になることを表しています。</p>

<p>さらに、両辺に $\theta$ をかけると、次の式が得られます。</p>

<p>$$\int P(\bar{X}|\theta) \theta \frac{\partial}{\partial\theta} \log (P(\bar{X}|\theta))  d\bar{X} = 0 \ . \tag{1}$$</p>

<p>次に、$\bar{X}$ から $\theta$ の不偏推定量 $\hat{\theta}$ が得られたとします。不偏推定量の定義から、 $\hat{\theta}$ の期待値は真の値 $\theta$ となります :</p>

<p>$$E[\hat{\theta}] = \int \hat{\theta}P(\bar{X}|\theta)d\bar{X}=\theta \ .$$</p>

<p>上式に対し、さきほどと同様の式変形を行います。</p>

<p>まず、上式の両辺を $\theta$ について微分すると、</p>

<p>$$\frac{\partial}{\partial \theta} \int  \hat{\theta}P(\bar{X}|\theta)d\bar{X}=1 \ . $$</p>

<p>さらに、微分演算子を積分の中にいれて、 $P(\bar{X}|\theta)/P(\bar{X}|\theta)=1$ をかけ、</p>

<p>$$\int \frac{P(\bar{X}|\theta)}{P(\bar{X}|\theta)} \hat{\theta} \frac{\partial}{\partial \theta}  P(\bar{X}|\theta)d\bar{X}=1 \ .$$</p>

<p>式変形すると、</p>

<p>$$\int P(\bar{X}|\theta) \hat{\theta} \frac{\partial}{\partial \theta} \log ( P(\bar{X}|\theta))d\bar{X}=1\ . \tag{2}$$</p>

<p>ここで、(2)式から(1)式をひくと、</p>

<p>$$\int P(\bar{X}|\theta) (\hat{\theta}-\theta) \frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta))d\bar{X}=1 \ .$$</p>

<p>これは、$(\hat{\theta} - \theta) \frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta))d\bar{X}$ の期待値を表しています :</p>

<p>$$E[(\hat{\theta} - \theta) \frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta))]=1 \ .$$</p>

<p>ここで、Cauchy-Schwarzの不等式から、確率変数A、Bについて、</p>

<p>$$E[A^2]E[B^2] \geq (E[AB])^2$$</p>

<p>が成り立つので、</p>

<p>$$E[(\hat{\theta}-\theta)^2]E[(\frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta)d\bar{X}))^2] \geq (E[(\hat{\theta} - \theta) \frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta))])^2=1 \ .$$</p>

<p>が成り立ちます。これを式変形すると、</p>

<p>$$E[(\hat{\theta}-\theta)^2] \geq E^{-1}[(\frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta)))^2] \ .$$</p>

<p>これがCramer-Raoの不等式です。</p>

<p>また、 $E[(\frac{\partial}{\partial \theta} \log (P(\bar{X}|\theta)))^2]$ をFisher 情報量と呼びます。</p>

<h2 id="参考文献">参考文献</h2>

<ul>
<li><a href="https://www.youtube.com/watch?v=j0Dy55ukoo4">Lec 11 Cramer Rao Bound CRB for Parameter Estimation, by Prof. Aditya K. Jagannatham in IIT Kanpur</a></li>
</ul>
                    </div>
                    
                </section>
            </div>
            <div class="footer">
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } ,
         extensions: ["AMSmath.js", "AMSsymbols.js"]
  }
});
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
  }
});
</script>


<script type="text/javascript">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    console.log(all.length);
     for(i = 0; i < all.length; i++) {
       all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script src="https://karadaharu.org//js/all.min.js"></script>

        </div>
    </div>
</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
